#include "cpptools_Timer.hpp"
#include "cpptools_Logger.hpp"
#include "Settings.hpp"

namespace imog {

// ====================================================================== //
// ====================================================================== //
// Get a chrono time point
// ====================================================================== //

TimePoint Timer::now() const { return StdClock::now(); };

// ====================================================================== //
// ====================================================================== //
// Compute elapsed time
// ====================================================================== //

double Timer::elapsedTime() const { return (now() - m_initTimeStamp).count(); }

// ====================================================================== //
// ====================================================================== //
// Constructor
// ====================================================================== //

Timer::Timer(const std::string& msg)
    : m_promptMsg(msg), m_initTimeStamp(now()) {}

// ====================================================================== //
// ====================================================================== //
// Destructor
// ====================================================================== //

Timer::~Timer() {
  auto msg = (!m_promptMsg.empty()) ? " - " + m_promptMsg : "";
  if (Settings::showTimes) LOGD("[[{}s]]{}", elapsedTime(), msg);
}

} // namespace imog
